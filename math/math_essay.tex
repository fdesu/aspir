\documentclass[14pt, a4paper]{article}

        \makeatletter

    %                From here.sty
    \ifx\@Hxfloat\@Hundef\else\expandafter\endinput\fi
    \let\@Hxfloat\@xfloat
    \def\@xfloat#1[{\@ifnextchar{H}{\@HHfloat{#1}[}{\@Hxfloat{#1}[}}
    \def\@HHfloat#1[H]{%
    \expandafter\let\csname end#1\endcsname\end@Hfloat
    \vskip\intextsep\def\@captype{#1}\parindent\z@
    \ignorespaces}
    \def\end@Hfloat{\vskip \intextsep}

  %  \renewcommand{\@oddhead}{\hfil —- \textrm{\thepage} —-\hfil}
    \renewcommand{\@biblabel}[1]{#1.} %pp.293,336
    \renewcommand{\@makecaption}[2]{%
    \vspace{\abovecaptionskip}%
    \sbox{\@tempboxa}{#1. #2} \ifdim \wd\@tempboxa >\hsize #1. #2\par
    \else \global\@minipagefalse \hbox to \hsize {\hfil #1. #2\hfil}%
    \fi \vspace{\belowcaptionskip}}

    \makeatother
%\usepackage{fontspec}
\usepackage[cp1251]{inputenc} 
\usepackage[english,russian]{babel} 
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{etoolbox}
\usepackage{graphicx} 
\usepackage[nottoc,notlot,notlof]{tocbibind}
\usepackage{pdfpages}
\usepackage[left=3cm,right=1.5cm,
    top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\renewcommand{\tiny}{\fontsize{7}{8.4pt}\selectfont}
\renewcommand{\scriptsize}{\fontsize{9}{11pt}\selectfont}
\renewcommand{\footnotesize}{\fontsize{11}{12pt}\selectfont}
\renewcommand{\small}{\fontsize{12}{12pt}\selectfont}
\renewcommand{\normalsize}{\fontsize{12}{12pt}\selectfont}
\renewcommand{\large}{\fontsize{17}{18pt}\selectfont}
\renewcommand{\Large}{\fontsize{20}{25pt}\selectfont}
\renewcommand{\baselinestretch}{1.5}
\parindent=1.25cm

\begin{document}

\makeatletter
\renewcommand\l@section[2]{%
  \ifnum \c@tocdepth >\z@
    \addpenalty\@secpenalty
    \addvspace{1.0em \@plus\p@}%
    \setlength\@tempdima{1.5em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      \leavevmode \bfseries
      \advance\leftskip\@tempdima
      \hskip -\leftskip
      #1\nobreak\
      \leaders\hbox{$\m@th\mkern \@dotsep mu\hbox{.}\mkern \@dotsep mu$}
     \hfil \nobreak\hb@xt@\@pnumwidth{\hss #2}\par
    \endgroup
  \fi}
\makeatother
{
\thispagestyle{empty}
\newpage
\centering

Санкт-Петербургский государственный университет\\

\vspace{200pt}

{\large \textbf{Эссе на тему:}}\\
\bigskip
{\large {Определение стохастичности орбит в одной модели несферической звездной системы}}\\

\vspace{400pt}

Санкт-Петербург

2015
\clearpage
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\tableofcontents
\newpage

\subsection*{Введение}
\addcontentsline{toc}{subsection}{Введение}
~\par
Каждая звезда под действием лишь регулярных сил должна описывать внутри стационарной звездной системы неизменную (т.е. не зависящую от времени) регулярную орбиту. С этой точки зрения динамика звездной системы определяется распределением регулярных орбит, что, впрочем, эквивалентно заданию координат и скоростей всех звезд данной системы (заданию фазового распределения) для какого-нибудь момента времени $t_0$, который может быть принят за <<начальный>> момент. Для многих изучение динамики началось и закончилось вторым законом Ньютона $F=mA$. Считается, что если заданы силы, действующие между звездами, а так же начальные положения и скорости звезд, то с помощью компьютера можно предсказать движение или развитие системы для любого сколь угодно позднего момента времени. Однако, таковые расчеты на компьютерах не привели к обещанной предсказуемости в динамике. Напротив, было обнаружено, что движение некоторых очень простых динамических систем не всегда можно предсказать на большой интервал времени. Такие движения были названы \textit{хаотическими}, и их исследования привлекли в динамику некоторые новые математические идеи. Термин <<хаотический>> применяется в тех детерминированных задачах, где отсутствуют случайные или непредсказуемые силы и параметры. Стоит также отметить, что задача рассчета орбит, используя компьютер --- не самая тривиальная, а также довольно часто она сопряжена с большими накладными расходами на компьютер или кластер, при помощи которого производятся рассчеты.\\

Создание модели галактики --- трудоемкая и серьезная задача. Благодаря точно смоделированной системе представляются широкие возможности для исследований. К примеру, А. Оллонгрен в 1962 году занимался построением орбит исходя из существующей модели Галактики. Им было вычислено чрезвычайно много орбит, которые затем были классифицированы.~\cite{OLLONGREN}. Стоит отметить, что система, которую он рассматривал имитировала нашу Галактику, а классифицированные орбиты позволили сделать чрезвычайно много полезных аналитических и практических выводов. Таким образом задача моделирования сводится к отысканию функциии $\Phi(\textbf{r}, t)$ --- потенциала галактики, который будет в последствии хорошо отвечать реальным движениям небесных тел.\\

\subsection*{Семейство ротационно-симметричных моделей звездных систем}
\addcontentsline{toc}{subsection}{Семейство ротационно-симметричных моделей звездных систем}
~\par
Гравитационное поле, или поле тяготения --- физическое поле, через которое осуществляется гравитационное взаимодействие, оно потенциально. Это значит, что можно ввести потенциальную энергию гравитационного притяжения пары тел, и эта энергия не изменится после перемещения тел по замкнутому контуру. Потенциальность гравитационного поля влечёт за собой закон сохранения энергии и при изучении движения тел в гравитационном поле часто существенно упрощает решение. В рамках ньютоновской механики гравитационное взаимодействие является дальнодействующим. Таким образом, как бы массивное тело ни двигалось, в любой точке пространства гравитационный потенциал зависит только от положения тела в данный момент времени~\cite{LandauLifshitz}. Для того, чтобы определить общий вид модели, с которым можно было бы работать, необходимо выбрать закон изменения потенциала $\varphi$. Возьмем его из работы~\cite{RaspopvaOssipkovJiang} и выберем трехмерное евклидово пространство и цилиндрическую систему координат $(R, \theta, z)$, с плоскостью симметрии $z=0$. В качестве потенциала $\varphi$ понимается скалярная функция координат, характеризующая гравитационное поле:

\begin{equation}\label{eq:xi}
        \varphi (\xi ) =  \frac{\alpha}{\alpha - 1 + w(\xi )} \text{,}\, w(\xi ) = (1 + \kappa \xi ^p)^{1/p},\, \kappa = O(\alpha ^p),
\end{equation}
\begin{equation}\label{equipotential}
        \xi ^2 = R^2 + z^2 + 2(1 - \varepsilon)(\sqrt{z^2 + \varepsilon ^2} - \varepsilon).
\end{equation}
Здесь $\alpha > 0,\, \kappa = O(\alpha),\, p > 0, \varepsilon \in [0,1] $ --- структурные параметры модели. Для того, чтобы получить частную модель для построения орбит и анализа их на стохастичность необходимо зафиксировать набор структурных параметров. Анализ плотности и хода потенциала показал, что набор параметров $\alpha = 2, p = 1.5, \varepsilon = 0.5$ отвечает неотрицательности плотности, а ход потенциала для такого набора гладкий. Таким образом мы получили физически корректную модель, в которой возможно строить орбиты.

\subsection*{Описание рабочей платформы}
\addcontentsline{toc}{subsection}{Описание рабочей платформы}
~\par
В настоящее время сфера применения многопроцессорных вычислительных систем (МВС) непрерывно расширяется, охватывая все новые области в различных отраслях науки, бизнеса и производства. Стремительное развитие кластерных систем создает благоприятные условия для использования многопроцессорной вычислительной техники во всех областях знаний.\\

Если присмотреться к проблеме построения орбит поближе, то несложно заметить, что ее довольно легко разбить на подзадачи, которые можно решить в параллельных потоках. В этом конкретном случае подзадача суть --- набор наборов начальных условий, из которого в итоге получится набор орбит и фрактальных размерностей Минковского. Тут стоит отметить, что данный подход --- не параллельные вычисления ради параллельных вычислений, а реальная необходимость, так как для того, чтобы получить большой набор высококачественных орбит и рассчитать для них фрактальную размерность, придется затратить довольно большой ресурс в виде времени. Как и в любой задаче распараллеливания, вопрос что брать за единицу исполнения или ``поток'' решен путем вынесения туда логики по построению орбиты с помощью численного метода Рунге-Кутта-Фельберга. Выбранные численный метод использует переменный шаг интегрирования, что накладывает дополнительные расходы на процессорное время вычисления в потоке. Выбранная схема интегрирования оперирует абсолютной погрешностью $10^{-7}$ и относительной погрешностью $10^{-6}$, что должно дать довольно точные, высококачественные орбиты.\\

В качестве рабочей платформы, на которой ведутся параллельные вычисления взят рабочий компьютер с достаточно вместительным SSD-хранилищем, что позволит сильно не беспокоиться о времени доступа к долговременной памяти, а в качестве основной вычислительной тяги взята архитектура NVIDIA CUDA в мультичиповом режиме SLI. CUDA --- это архитектура параллельных вычислений от NVIDIA, позволяющая существенно увеличить вычислительную производительность благодаря использованию GPU (графических процессоров). Также CUDA --- C-подобный язык программирования со своим компилятором и библиотеками для вычислений на GPU. Конечно же, написание оптимального кода для видеочипов совсем не такое простое и эта задача нуждается в длительной ручной работе, но CUDA как раз и раскрывает все возможности и даёт программисту больший контроль над аппаратными возможностями GPU.

\subsection*{Построение орбит}
\addcontentsline{toc}{subsection}{Построение орбит}
~\par
Численное решение уравнений движения позволяет проанализировать свойства галактических орбит в реалистичных моделях галактик. При этом использование сложных моделей потенциалов не дает возможности аналитического решения уравнений движения, и орбиты звёзд приходится получать только путем их численного решения. Под \textit{орбитой звезды} понимается орбита материальной точки единичной массы. Однако для многих задач необходимо получение параметров орбит звёзд и скоплений именно в реалистичных моделях. В качестве примера можно указать задачу о получении мест рождения звёздных скоплений, когда орбиты рассчитываются назад по времени на величину возраста скопления. С помощью анализа орбит исследуется возможность длительного существования движущихся групп звёзд.\\

Для расчета орбит будем решать задачу Коши, в которой система обыкновенных дифференциальных уравнений в общем случае имеет вид:

\begin{equation}\label{zK}
\ddot{\textbf{r}} = \nabla \varphi, \qquad \textbf{r}(t_0)=\textbf{r}_0,\, \textbf{v}(t_0)=\textbf{v}_0,
\end{equation}
где $\textbf{r}$~--- радиус-вектор пробной звезды, $\textbf{v}$~--- вектор скорости, $\nabla$~--- векторный оператор набла.
$$
\textbf{r} = (R, \theta, z)^T, \quad
\nabla = \left( \frac{\partial}{\partial R}, \frac{1}{R}\frac{\partial}{\partial \theta}, \frac{\partial}{\partial z} \right)^T
$$

Для стационарной ротационно-симметричной модели имеют место интегралы энергии $ E $ и площадей $ I $~\cite{ogor}

\begin{equation}\label{EI}
E = \frac{1}{2}(v_R^2 + v_z^2 + v_{\theta}^2) - \varphi(\xi) , \quad
I = R v_{\theta}
\end{equation}
где $v_R, v_{\theta}, v_z$~--- компоненты скорости соответствующих цилиндрических координат $R, \theta, z$.
Тогда задача сводится к решению системы шести обыкновенных дифференциальных уравнений. Благодаря интегралам энергии $E$ и площадей $I$ получаем систему, состоящую из 5 дифференциальных уравнений~\cite{KutuzovOssipkov}:

\begin{equation}\label{systRz}
\left\{ \begin{aligned}
&\dot R = \, v_R, & \, \dot v_R & = \frac{I^2}{R^3} + \frac{\partial \varphi }{\partial R },\\
&\dot \theta = \, \frac I{R^2}, & , \dot v_z & = \frac{\partial \varphi}{\partial z },\\
&\dot z = \, v_z. &
\end{aligned}
\right.
\end{equation} 

Ранее зафиксированный набор структурных параметров $\alpha = 2, p = 1.5, \varepsilon = 0.5$ позволяет построить орбиты. В случае ротационной симметрии удобно изображать орбиты в меридиональной плоскости $(R,z)$, которая сопутствует звезде.

{
\begin{figure}[H]
\centering
\begin{minipage}[t]{0.7\textwidth}
\centering
\includegraphics[width=\linewidth]{dual1.png}
\end{minipage}
\caption{Проекции орбиты на сопутствующую плоскость в модели~(\ref{eq:xi})~(\ref{equipotential}). Значения интегралов площадей и энергии $I_1 = 0.072$, $E_1 = 0.69$ (справа), $I_2 = 0.232$, $E_2 = 0.46$(слева).}
\end{figure}
}

\subsection*{Определение фрактальной меры}
\addcontentsline{toc}{subsection}{Определение фрактальной меры}
~\par
Для выявления признаков хаотических движений, наличие которых можно было бы предполагать в модели с центральным пиком плотности, используются фрактальные свойства движения в фазовом пространстве, которые характеризуются фрактальными размерностями~\cite{Mun}. \\

Фрактальная размерность есть количественная мера фрактальной природы аттрактора. Размерность точечного множества можно определить многими способами. Опишем весьма наглядное, или геометрическое определение размерности, называемое емкостью.
Пусть $N_0$ --- некоторое распределение точек, тогда определение фрактальной размерности выглядит так:
\begin{equation}\label{FRAC_RAZM_DEFINITION}
	d_c = \lim_{l \to  0} \frac{   \ln{N(l)}   }{   \ln{(1/l)}   }
\end{equation}
где $N(l)$ --- число кубов со стороной $l$, покрывающих заданное множество. $N(l) < N_0$.
Неявно в этом определении содержится требование, согласно которому число точек в множестве должно быть большим, или $N_0 \to \infty$.\\
Точечное множество называется фрактальным, если оно имеет нецелую размерность. 
Существуют два возражения против использования емкости в качестве меры фрактальной размерности. Во-первых, емкостная размерность --- геометрическая мера, т.е. она не учитывает частоту, с которой траектория посещает элемент покрытия. Во-вторых, подсчет гиперкубов, образующих покрытие множества в фазовом пространстве, требует очень больших затрат вычислительного времени. Однако, емкостная мера остается адекватной и справедливой.~\cite{Mun}

\subsection*{Box-counting алгоритм}
\addcontentsline{toc}{subsection}{Box-counting алгоритм}
~\par
Изложим алгоритм, используя который были вычислены фрактальные размерности.\\
Пусть задано компактное множество $A \in \mathbb{R}$ объединением шаров и просуммируем их объемы (или меры в общем случае). Пусть $N(l)$ --- минимальное число шаров радиуса $l$, необходимых для покрытия компактного множества $A$. Их суммарный объем $V$ пропорционален $N(l)\cdot l^D$. При $l \to 0$, $N(l) \to \frac{\text{const}}{l^D}$. Тут логарифмируем и получаем $\ln N(l) \to \ln(\text{const}) - D\ln l$. Отсюда находим: 
$$
\frac{\ln(\text{const}) - \ln N(l)}{\ln l} \to D.
$$
При $l \to 0$ значение $\ln(\text{const})$ пренебрежимо мало по сравнению $\ln N(l)$. Таким образом приходим к определению размерности Минковского:
\begin{equation}\label{Dimension}
d_M(A) =  \lim_{l \to 0} \frac{\ln N(l)}{-\ln l}.
\end{equation}
Пусть в уравнении~\ref{Dimension} $D_M = d_M$ --- приближенное значение размерности Минковского. Запишем определение этой размерности, убрав предел, его мы будем имитировать в итерациях, в которых будет изменяться размер ячеек. Если зафиксировать размеры ячеек $l$ и рассматривать $D_M$ как неизвестное, то легко заметить, что приведенное выражение является формулой линии. Мы можем запустить цикл по различным размерам ячеек $l$ и записывать результат $D_M$. Если нанести эти результаты на график и построить линию регрессии для полученного множества данных, это значение и будет являться аппроксимацией фрактальной размерности Минковского.\\

Стоит отметить, что если верхний предел не существует, все еще можно взять супремум и инфинум, которые соотвественно определяют \textbf{верхнюю box-размерность (upper box dimension)} и \textbf{нижнюю box-размерность (lower box dimension)}. Верхняя размерность иногда называют размерностью энтропии (entropy dimension),  размерностью Колмогорова (Kolmogorov dimension), объем Колмогорова (Kolmogorov capacity), предельный объем (limit capacity) или верхняя размерность Минковского (upper Minkowski dimension). В то же время нижняя размерность так же называется нижняя размерность Минковского (lower Minkowski dimension~\cite{MINKOWSKI}).\\

\subsection*{Подсчет фрактальной размерности}
\addcontentsline{toc}{subsection}{Подсчет фрактальной размерности}
~\par
У нас уже имеются построенные орбиты. Построим для них сечения Пуанкаре и рассчитаем их фрактальную размерность. Некоторые результаты представлены на рисунке~\ref{stohast:1}.
{
\begin{figure}[H]
\centering
\begin{minipage}[t]{0.5\textwidth}
\centering
\includegraphics[width=\linewidth]{1_FULL.jpg}
\end{minipage}
\caption{Орита и вывод box-count алгоритма. Фрактальная размерность $f = 1.8458 \pm 0.2889$}\label{stohast:1}
\end{figure}
}

На представленном риунке изображена орбита и соответствующий ей вывод box-count алгоритма. По горизонтальной оси идет размер ячеек, а по вертикальной оси отношение натуральных логарифмов попавших в ячейку точек (count) к размеру ячейки (box). В подписях к рисунку указана фрактальная размерность $f$ для орбиты.\\

\section*{Заключение}
\addcontentsline{toc}{section}{Заключение}
~\par
В представленной работе была рассмотренная обобщенная ротационно-сим\-мет\-рич\-ная модель звездной системы и разработан метод анализа хаотичности.\\

Рассмотрено трехапараметрическое семейство потенциалов и исследованная ассимптотика в нуле и на бесконечности, и сделан вывод, что выбранный потенциал не имеет особенностей. Рассмотрена задача Коши, в результате решения которой был получен набор орбит (около 1000). Был выбран метод численного интегрирования Рунге-Кутта-Фельберга и соответствующие значения относительной и абсолютной погрешностей для того, чтобы получить достаточно точные решения. Построен и проанализирован набор орбит, а также сделан вывод, что большинство вычисленных орбит оказались ящичного типа.\\

Для построенных орбит вычислены соответствующие фрактальные размерности, которые хоть и оказались дробными, но близкими к целому значению. Разработан алгоритм вычисления фрактальных размерностей и выполнены предварительные расчеты. Построенный набор орбит позволил заключить, что малым изменениям начальных условий при решении задачи Коши отвечает малое изменение построенных орбит.

\begin{thebibliography}{4.}

\bibitem{KutuzovOssipkov} Кутузов С.А., Распопова Н.В. Рельеф поля сил и орбиты в модели галактики // Вестник СПбГУ. Сер. 10. 2008. вып. 1. С. 32-42.

\bibitem{LandauLifshitz} Ландау Л.Д., Лифшиц Е.М. Теоретическая физика: Учеб. пособ.: Для вузов. В 10 т. Т.II. Теория поля.. 8 изд. М: ФИЗМАТЛИТ, 2003.  536~с.

\bibitem{Mun} Мун~Ф. Хаотические колебания: Вводный курс для научных работников и инженеров: Пер. с англ. М.: Мир, 1990. 312\,с.

\bibitem{ogor} Огородников~К.\:Ф. Динамика звездных систем. М: Физматгиз, 1958. 644~с.

\bibitem{RaspopvaOssipkovJiang}  Raspopova~N.V., Ossipkov~L.P., Jiang~Z. A New Model for Dark Halo of Spherical Galaxies // Astronomical and Astrophysical Transactions. 2012. Vol 27. Issue 3, pp 433-436.

\bibitem{OLLONGREN} A. Ollongren, BAN, 16, 241 (1962).

\bibitem{HENON} Henon's Isochrone Model // arXiv.org URL: \url{http://arxiv.org/abs/1411.4937}

\bibitem{MINKOWSKI} Minkowski–Bouligand dimension // Wikipedia URL: \url{http://en.wikipedia.org/wiki/Minkowski-Bouligand_dimension}

\end{thebibliography}


\end{document}