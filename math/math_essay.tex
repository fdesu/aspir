\documentclass[14pt, a4paper]{article}

        \makeatletter

    %                From here.sty
    \ifx\@Hxfloat\@Hundef\else\expandafter\endinput\fi
    \let\@Hxfloat\@xfloat
    \def\@xfloat#1[{\@ifnextchar{H}{\@HHfloat{#1}[}{\@Hxfloat{#1}[}}
    \def\@HHfloat#1[H]{%
    \expandafter\let\csname end#1\endcsname\end@Hfloat
    \vskip\intextsep\def\@captype{#1}\parindent\z@
    \ignorespaces}
    \def\end@Hfloat{\vskip \intextsep}

  %  \renewcommand{\@oddhead}{\hfil —- \textrm{\thepage} —-\hfil}
    \renewcommand{\@biblabel}[1]{#1.} %pp.293,336
    \renewcommand{\@makecaption}[2]{%
    \vspace{\abovecaptionskip}%
    \sbox{\@tempboxa}{#1. #2} \ifdim \wd\@tempboxa >\hsize #1. #2\par
    \else \global\@minipagefalse \hbox to \hsize {\hfil #1. #2\hfil}%
    \fi \vspace{\belowcaptionskip}}

    \makeatother
%\usepackage{fontspec}
\usepackage[cp1251]{inputenc} 
\usepackage[english,russian]{babel} 
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{etoolbox}
\usepackage{graphicx} 
\usepackage[nottoc,notlot,notlof]{tocbibind}
\usepackage{pdfpages}
\usepackage[left=3cm,right=1.5cm,
    top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\renewcommand{\tiny}{\fontsize{7}{8.4pt}\selectfont}
\renewcommand{\scriptsize}{\fontsize{9}{11pt}\selectfont}
\renewcommand{\footnotesize}{\fontsize{11}{12pt}\selectfont}
\renewcommand{\small}{\fontsize{12}{12pt}\selectfont}
\renewcommand{\normalsize}{\fontsize{12}{12pt}\selectfont}
\renewcommand{\large}{\fontsize{17}{18pt}\selectfont}
\renewcommand{\Large}{\fontsize{20}{25pt}\selectfont}
\renewcommand{\baselinestretch}{1.5}
\parindent=1.25cm

\begin{document}

\makeatletter
\renewcommand\l@section[2]{%
  \ifnum \c@tocdepth >\z@
    \addpenalty\@secpenalty
    \addvspace{1.0em \@plus\p@}%
    \setlength\@tempdima{1.5em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      \leavevmode \bfseries
      \advance\leftskip\@tempdima
      \hskip -\leftskip
      #1\nobreak\
      \leaders\hbox{$\m@th\mkern \@dotsep mu\hbox{.}\mkern \@dotsep mu$}
     \hfil \nobreak\hb@xt@\@pnumwidth{\hss #2}\par
    \endgroup
  \fi}
\makeatother
{
\thispagestyle{empty}
\newpage
\centering

Санкт-Петербургский государственный университет\\

\vspace{200pt}

{\large \textbf{Эссе на тему:}}\\
\bigskip
{\large {Построение орбит и определение их стохастичности, используя параллельные вычисления}}\\

\vspace{400pt}

Санкт-Петербург

2015
\clearpage
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\tableofcontents
\newpage

\subsection*{Введение}
\addcontentsline{toc}{subsection}{Введение}
~\par
Каждая звезда под действием лишь регулярных сил должна описывать внутри стационарной звездной системы неизменную (т.е. не зависящую от времени) регулярную орбиту. С этой точки зрения динамика звездной системы определяется распределением регулярных орбит, что, впрочем, эквивалентно заданию координат и скоростей всех звезд данной системы (заданию фазового распределения) для какого-нибудь момента времени $t_0$, который может быть принят за <<начальный>> момент. С этого момента в дело идет математическое моделирование, позволяющее глубже и на количественном уровне установить связь между различными сторонами такого явления, как динамика звездной системы. В результате разработки математической модели делаются предсказания, которые проверяются новыми наблюдениями или экспериментами. Хорошее согласие говорит об адекватности модели. Напротив, если имеют место расхождения, то необходимо пересмотреть исходную физическую модель и установить новые физические закономерности.\\

Для многих изучение динамики началось и закончилось вторым законом Ньютона $F=mA$. Считается, что если заданы силы, действующие между звездами, а так же начальные положения и скорости звезд, то с помощью компьютера можно предсказать движение или развитие системы для любого сколь угодно позднего момента времени. Однако, таковые расчеты на компьютерах не привели к обещанной предсказуемости в динамике. Напротив, было обнаружено, что движение некоторых очень простых динамических систем не всегда можно предсказать на большой интервал времени. Такие движения были названы \textit{хаотическими}, и их исследования привлекли в динамику некоторые новые математические идеи. Термин <<хаотический>> применяется в тех детерминированных задачах, где отсутствуют случайные или непредсказуемые силы и параметры. Стоит также отметить, что задача расчета орбит, используя компьютер --- не самая тривиальная, а также довольно часто она сопряжена с большими накладными расходами на компьютер или кластер, при помощи которого производятся расчеты.\\

Создание модели галактики --- трудоемкая и серьезная задача. Благодаря точно смоделированной системе представляются широкие возможности для исследований. К примеру, А. Оллонгрен в 1962 году занимался построением орбит исходя из существующей модели Галактики. Им было вычислено чрезвычайно много орбит, которые затем были классифицированы~\cite{OLLONGREN}. Стоит отметить, что система, которую он рассматривал, имитировала нашу Галактику, а классифицированные орбиты позволили сделать чрезвычайно много полезных аналитических и практических выводов. Таким образом, задача моделирования сводится к отысканию функции $\Phi(\textbf{r}, t)$ --- потенциала галактики, который будет в последствии хорошо отвечать реальным движениям небесных тел.\\

Целью данной работы является рассмотрение эффективного подхода к получению большого, а может быть и чрезвычайно большого количества орбит благодаря методу параллельных вычислений. Следуя примеру Оллонгрена~\cite{OLLONGREN}, такой большой массив данных можно проанализировать и прийти к некоторым заключениям. Стоит также отметить, что данный подход в звездной динамике имеет очевидные плюсы: большой объем данных, полученных численным экспериментом, возможность применить алгоритмы Big Data и Data Mining для решения каких-то специфических задач в заданной математической модели галактики.

\subsection*{Семейство ротационно-симметричных моделей звездных систем}
\addcontentsline{toc}{subsection}{Семейство ротационно-симметричных моделей звездных систем}
~\par
Гравитационное поле, или поле тяготения --- физическое поле, через которое осуществляется гравитационное взаимодействие, оно потенциально. Это значит, что можно ввести потенциальную энергию гравитационного притяжения пары тел, и эта энергия не изменится после перемещения тел по замкнутому контуру. Потенциальность гравитационного поля влечёт за собой закон сохранения энергии и при изучении движения тел в гравитационном поле часто существенно упрощает решение. В рамках ньютоновской механики гравитационное взаимодействие является дальнодействующим. Таким образом, как бы массивное тело ни двигалось, в любой точке пространства гравитационный потенциал зависит только от положения тела в данный момент времени~\cite{LandauLifshitz}. Для того, чтобы определить общий вид модели, с которым можно работать, необходимо выбрать закон изменения потенциала $\varphi$. Возьмем его из работы~\cite{RaspopvaOssipkovJiang} и выберем трехмерное евклидово пространство и цилиндрическую систему координат $(R, \theta, z)$, с плоскостью симметрии $z=0$. В качестве потенциала $\varphi$ понимается скалярная функция координат, характеризующая гравитационное поле:

\begin{equation}\label{eq:xi}
        \varphi (\xi ) =  \frac{\alpha}{\alpha - 1 + w(\xi )} \text{,}\, w(\xi ) = (1 + \kappa \xi ^p)^{1/p},\, \kappa = O(\alpha ^p),
\end{equation}
\begin{equation}\label{equipotential}
        \xi ^2 = R^2 + z^2 + 2(1 - \varepsilon)(\sqrt{z^2 + \varepsilon ^2} - \varepsilon).
\end{equation}
Здесь $\alpha > 0,\, \kappa = O(\alpha),\, p > 0, \varepsilon \in [0,1] $ --- структурные параметры модели. Для того, чтобы получить частную модель для построения орбит и анализа их на стохастичность необходимо зафиксировать набор структурных параметров. Анализ плотности и хода потенциала показал, что набор параметров $\alpha = 2, p = 1.5, \varepsilon = 0.5$ отвечает неотрицательности плотности, а ход потенциала для такого набора гладкий. Таким образом, мы получили физически корректную модель, в которой возможно строить орбиты.

\newpage
\subsection*{Описание рабочей платформы}
\addcontentsline{toc}{subsection}{Описание рабочей платформы}
~\par
В настоящее время сфера применения многопроцессорных вычислительных систем (МВС) непрерывно расширяется, охватывая все новые области в различных отраслях науки, бизнеса и производства. Стремительное развитие кластерных систем создает благоприятные условия для использования многопроцессорной вычислительной техники во всех областях знаний.\\

Если присмотреться к проблеме построения орбит поближе, то несложно заметить, что ее довольно легко разбить на подзадачи, которые можно решить в параллельных потоках. В этом конкретном случае подзадача суть --- набор наборов начальных условий, из которого в итоге получится множество пар орбит и фрактальных размерностей Минковского. Тут стоит отметить, что данный подход --- не параллельные вычисления ради параллельных вычислений, а реальная необходимость, так как для того, чтобы получить большой набор высококачественных орбит и рассчитать для них фрактальную размерность, придется затратить довольно большой ресурс в виде времени. Как и в любой задаче распараллеливания, вопрос, что брать за единицу исполнения или ``поток'' решен путем вынесения туда логики по построению орбиты с помощью численного метода Рунге-Кутта-Фельберга. И пусть для начала количество исполняемых потоков будет равно 8. Выбранный численный метод использует переменный шаг интегрирования, что накладывает дополнительные расходы на процессорное время вычисления шага в потоке. Выбранная схема интегрирования оперирует абсолютной погрешностью $10^{-7}$ и относительной погрешностью $10^{-6}$, что должно дать довольно точные, высококачественные орбиты.\\

В качестве рабочей платформы, на которой ведутся параллельные вычисления, взят рабочий компьютер с достаточно вместительным SSD-хранилищем, что позволит сильно не беспокоиться о времени доступа к долговременной памяти, а в качестве основной вычислительной мощности взята архитектура NVIDIA CUDA в мультичиповом режиме SLI. CUDA --- это архитектура параллельных вычислений от NVIDIA, позволяющая существенно увеличить вычислительную производительность благодаря использованию GPU (графических процессоров). Также CUDA --- C-подобный язык программирования со своим компилятором и библиотеками для вычислений на GPU. Конечно же, написание оптимального кода для видеочипов совсем не такое простое и эта задача нуждается в длительной ручной работе, но CUDA как раз и раскрывает все возможности и даёт программисту больший контроль над аппаратными возможностями GPU.

\subsection*{Построение орбит}
\addcontentsline{toc}{subsection}{Построение орбит}
~\par
Численное решение уравнений движения позволяет проанализировать свойства галактических орбит в реалистичных моделях галактик. При этом использование сложных моделей потенциалов не дает возможности аналитического решения уравнений движения, и орбиты звёзд приходится получать только путем их численного решения. Под \textit{орбитой звезды} понимается орбита материальной точки единичной массы. Однако для многих задач необходимо получение параметров орбит звёзд и скоплений именно в реалистичных моделях. В качестве примера можно указать задачу о получении мест рождения звёздных скоплений, когда орбиты рассчитываются назад по времени на величину возраста скопления. С помощью анализа орбит исследуется возможность длительного существования движущихся групп звёзд.\\

Для расчета орбит будем решать задачу Коши параллельно в каждом потоке. Система обыкновенных дифференциальных уравнений в общем случае имеет вид:

\begin{equation}\label{zK}
\ddot{\textbf{r}} = \nabla \varphi, \qquad \textbf{r}(t_0)=\textbf{r}_0,\, \textbf{v}(t_0)=\textbf{v}_0,
\end{equation}
где $\textbf{r}$~--- радиус-вектор пробной звезды, $\textbf{v}$~--- вектор скорости, $\nabla$~--- векторный оператор набла.
$$
\textbf{r} = (R, \theta, z)^T, \quad
\nabla = \left( \frac{\partial}{\partial R}, \frac{1}{R}\frac{\partial}{\partial \theta}, \frac{\partial}{\partial z} \right)^T
$$

Для стационарной ротационно-симметричной модели имеют место интегралы энергии $ E $ и площадей $ I $~\cite{ogor}

\begin{equation}\label{EI}
E = \frac{1}{2}(v_R^2 + v_z^2 + v_{\theta}^2) - \varphi(\xi) , \quad
I = R v_{\theta}
\end{equation}
где $v_R, v_{\theta}, v_z$~--- компоненты скорости соответствующих цилиндрических координат $R, \theta, z$.
Тогда задача сводится к решению системы шести обыкновенных дифференциальных уравнений. Благодаря интегралам энергии $E$ и площадей $I$ получаем систему, состоящую из 5 дифференциальных уравнений~\cite{KutuzovOssipkov}:

\begin{equation}\label{systRz}
\left\{ \begin{aligned}
&\dot R = \, v_R, & \, \dot v_R & = \frac{I^2}{R^3} + \frac{\partial \varphi }{\partial R },\\
&\dot \theta = \, \frac I{R^2}, & , \dot v_z & = \frac{\partial \varphi}{\partial z },\\
&\dot z = \, v_z. &
\end{aligned}
\right.
\end{equation} 

Ранее зафиксированный набор структурных параметров $\alpha = 2, p = 1.5, \varepsilon = 0.5$ позволяет построить орбиты. В случае ротационной симметрии удобно изображать орбиты в меридиональной плоскости $(R,z)$, которая сопутствует звезде.

{
\begin{figure}[H]
\centering
\begin{minipage}[t]{1\textwidth}
\centering
\includegraphics[width=\linewidth]{dual1.png}
\end{minipage}
\caption{Проекции орбиты на сопутствующую плоскость в модели~(\ref{eq:xi})~(\ref{equipotential}). Значения интегралов площадей и энергии $I_1 = 0.072$, $E_1 = 0.69$ (справа), $I_2 = 0.232$, $E_2 = 0.46$(слева).}
\end{figure}
}

\subsection*{Box-counting рассчеты для соответсвующей орбиты}
\addcontentsline{toc}{subsection}{Box-counting рассчеты для соответсвующей орбиты}
~\par
После того, как мы получили построенную орбиту, необходимо каким-то образом понять, регулярна ли она. Для определения стохастичности орбит задействуем алгоритм определения фрактальных размерностей через вычисление размерности Минковского. Так как поток выполнения атомарен и в нашем случае не предполагается никаких разделенных данных, то вычислить размерность Минковского необходимо в том же потоке, в котором построена орбита. То, что мы не предполагаем никаких разделенных данных, помимо тех, что автоматически аллоцируются при помощи CUDA, обусловлено тем, что это не имеет никакого смысла. Построенная схема вычисления также обусловлена тем, что операции построения орбиты и вычисления фрактальной размерности должны быть выполнены последовательно. Кроме того такое решение обладает гораздо большей перспективой масштабирования, чем аналогичная схема с синхронизацией потоков и распределенным кэшем. Опишем алгоритм, благодаря которому были вычислены фрактальные размерности --- это так называемый Box-counting алгоритм.\\

Пусть задано компактное множество $A \in \mathbb{R}$ объединением шаров и просуммируем их объемы (или меры в общем случае). Пусть $N(l)$ --- минимальное число шаров радиуса $l$, необходимых для покрытия компактного множества $A$. Их суммарный объем $V$ пропорционален $N(l)\cdot l^D$. При $l \to 0$, $N(l) \to \frac{\text{const}}{l^D}$. Тут логарифмируем и получаем $\ln N(l) \to \ln(\text{const}) - D\ln l$. Отсюда находим: 
$$
\frac{\ln(\text{const}) - \ln N(l)}{\ln l} \to D.
$$
При $l \to 0$ значение $\ln(\text{const})$ пренебрежимо мало по сравнению $\ln N(l)$. Таким образом, приходим к определению размерности Минковского:
\begin{equation}\label{Dimension}
d_M(A) =  \lim_{l \to 0} \frac{\ln N(l)}{-\ln l}.
\end{equation}
Пусть в уравнении~(\ref{Dimension}) $D_M = d_M$ --- приближенное значение размерности Минковского. Запишем определение этой размерности, убрав предел, его мы будем имитировать в итерациях, в которых будет изменяться размер ячеек. Если зафиксировать размеры ячеек $l$ и рассматривать $D_M$ как неизвестное, то легко заметить, что приведенное выражение является формулой линии. Мы можем запустить цикл по различным размерам ячеек $l$ и записывать результат $D_M$. Если нанести эти результаты на график и построить линию регрессии для полученного множества данных, это значение и будет являться аппроксимацией фрактальной размерности Минковского.\\

Стоит отметить, что если верхний предел не существует, все еще можно взять супремум и инфинум, которые соответственно определяют \textbf{верхнюю box-размерность (upper box dimension)} и \textbf{нижнюю box-размерность (lower box dimension)}. Верхняя размерность иногда называют размерностью энтропии (entropy dimension),  размерностью Колмогорова (Kolmogorov dimension), объем Колмогорова (Kolmogorov capacity), предельный объем (limit capacity) или верхняя размерность Минковского (upper Minkowski dimension). В то же время нижняя размерность так же называется нижняя размерность Минковского (lower Minkowski dimension~\cite{MINKOWSKI}). Также стоит отметить, что точечное множество называется фрактальным, если оно имеет нецелую размерность~\cite{Mun}. А учитывая, что выявления признаков хаотических движений возложено на фрактальные свойства движения в фазовом пространстве --- фрактальные размерности, можно полагать, что дробная размерность даст нерегулярные орбиты.\\

У нас уже имеются построенные орбиты. Рассчитаем их фрактальную размерность, отобразив некоторые полученные результаты на рисунке~\ref{stohast:1}.
{
\begin{figure}[H]
\centering
\begin{minipage}[t]{\textwidth}
\centering
\includegraphics[width=0.75\linewidth]{1_FULL.jpg}
\end{minipage}
\caption{Орита и вывод box-count алгоритма. Фрактальная размерность $f = 1.8458 \pm 0.2889$}\label{stohast:1}
\end{figure}
}

На представленном рисунке изображена орбита и соответствующий ей вывод box-count алгоритма. По горизонтальной оси идет размер ячеек, а по вертикальной оси отношение натуральных логарифмов попавших в ячейку точек (count) к размеру ячейки (box). В подписях к рисунку указана фрактальная размерность $f$ для орбиты.\\

\section*{Заключение}
\addcontentsline{toc}{section}{Заключение}
~\par
В представленной работе была рассмотрена обобщенная ротационно-сим\-мет\-рич\-ная модель звездной системы и разработан параллельный метод построения множества орбит и анализ их на хаотичность. Описана рабочая платформа, на которой были выполнены параллельные расчеты. Рассмотрена задача Коши, в результате решения которой был получен набор орбит (около 50000). Был выбран метод численного интегрирования Рунге-Кутта-Фельберга и соответствующие значения относительной и абсолютной погрешностей для того, чтобы получить достаточно точные решения. Построен и проанализирован набор орбит, а также сделан вывод, что большинство вычисленных орбит оказались ящичного типа.\\

Для построенных орбит вычислены соответствующие фрактальные размерности, которые хоть и оказались дробными, но близкими к целому значению. Разработан параллельный алгоритм вычисления множества фрактальных размерностей и выполнены предварительные расчеты. Построенный набор орбит позволил заключить, что малым изменениям начальных условий при решении задачи Коши отвечает малое изменение построенных орбит. Также отмечено резкое увеличение производительности по сравнения с последовательной схемой вычисления того же количества орбит и расчета их фрактальных размерностей. Выигранное время за счет параллелизма в среднем равно 63\%, а огромные наборы информации, порождаемые данной схемой вычислений, в перспективе можно использовать, как тренировочные множества для обучения нейронных сетей или других самообучающихся систем. Кроме того, проведя дополнительные расчеты, можно сменить рассматриваемую модель на какую-либо другую и применять данную схему в рамках другой модели галактики.


\begin{thebibliography}{4.}

\bibitem{KutuzovOssipkov} Кутузов С.А., Распопова Н.В. Рельеф поля сил и орбиты в модели галактики // Вестник СПбГУ. Сер. 10. 2008. вып. 1. С. 32-42.

\bibitem{LandauLifshitz} Ландау Л.Д., Лифшиц Е.М. Теоретическая физика: Учеб. пособ.: Для вузов. В 10 т. Т.II. Теория поля.. 8 изд. М: ФИЗМАТЛИТ, 2003.  536~с.

\bibitem{Mun} Мун~Ф. Хаотические колебания: Вводный курс для научных работников и инженеров: Пер. с англ. М.: Мир, 1990. 312\,с.

\bibitem{ogor} Огородников~К.\:Ф. Динамика звездных систем. М: Физматгиз, 1958. 644~с.

\bibitem{RaspopvaOssipkovJiang}  Raspopova~N.V., Ossipkov~L.P., Jiang~Z. A New Model for Dark Halo of Spherical Galaxies // Astronomical and Astrophysical Transactions. 2012. Vol 27. Issue 3, pp 433-436.

\bibitem{OLLONGREN} A. Ollongren, BAN, 16, 241 (1962).

\bibitem{HENON} Henon's Isochrone Model // arXiv.org URL: \url{http://arxiv.org/abs/1411.4937}

\bibitem{MINKOWSKI} Minkowski–Bouligand dimension // Wikipedia URL: \url{http://en.wikipedia.org/wiki/Minkowski-Bouligand_dimension}

\end{thebibliography}


\end{document}